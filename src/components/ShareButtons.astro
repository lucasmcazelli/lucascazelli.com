---
const url = Astro.url.toString();
const text = encodeURIComponent(Astro.props?.title ?? "");
---

<div class="flex items-center gap-2">
  <a
    href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`}
    target="_blank"
    rel="noopener noreferrer"
    class="rounded border border-muted px-3 py-1 text-sm hover:opacity-80"
  >LinkedIn</a>
  <a
    href={`https://x.com/intent/tweet?url=${encodeURIComponent(url)}&text=${text}`}
    target="_blank"
    rel="noopener noreferrer"
    class="rounded border border-muted px-3 py-1 text-sm hover:opacity-80"
  >X</a>
  <button
    id="copy-link-btn"
    type="button"
    class="rounded border border-muted px-3 py-1 text-sm hover:opacity-80"
  >Copy link</button>
</div>

<script is:inline>
  document.addEventListener("astro:page-load", () => {
    const btn = document.getElementById("copy-link-btn");
    btn?.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(window.location.href);
        btn.textContent = "Copied";
        setTimeout(() => (btn.textContent = "Copy link"), 800);
      } catch {}
    });
  });
  document.addEventListener("astro:after-swap", () => {
    const btn = document.getElementById("copy-link-btn");
    btn?.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(window.location.href);
        btn.textContent = "Copied";
        setTimeout(() => (btn.textContent = "Copy link"), 800);
      } catch {}
    });
  });
</script>
